!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("dialog",["jquery"],t):e.Dialog=t(e.jQuery)}(this,function(e){"use strict";function t(e,t){var n=window.getComputedStyle,o=n?n(e,null):e.currentStyle;if(o)return t=t.replace(/-(\w)/gi,function(e,t){return t.toUpperCase()}),o[t]}function n(){var t=this;t.destroyed=!1,t.node=document.createElement("div"),t.__node=e(t.node).css({display:"none",position:"absolute",outline:0}).attr("tabindex","-1")}e="default"in e?e["default"]:e;var o=Array.prototype,r=o.filter,i=o.indexOf,a=o.forEach,l=r?function(e,t,n){return r.call(e,t,n)}:function(e,t,n){for(var o,r=[],i=e.length>>>0,n=arguments.length>=3?arguments[2]:e,a=0;a<i;a++)a in e&&(o=e[a],t.call(n,o,a,e)&&r.push(o));return r},s=i?function(e,t,n){return i.call(e,t,n)}:function(e,t,n){var o=e.length>>>0;for(n=Number(n)||0,n=Math[n<0?"ceil":"floor"](n),n<0&&(n=Math.max(n+o,0));n<o;n++)if(n in e&&e[n]===t)return n;return-1},c=a?function(e,t,n){a.call(e,t,n)}:function(e,t,n){arguments.length<3&&(n=e);for(var o=0,r=e.length;o<r;o++)t.call(e,e[o],o,e)},f=document.documentElement.style,u=["Webkit","Moz","O","ms","Khtml"],d=function(){if(void 0!==f.animationName)return{property:"animation",event:"animationend"};for(var e,t=0,n=u.length;t<n;t++)if(void 0!==f[u[t]+"AnimationName"])return e=u[t],{property:e+"Animation",event:e+"AnimationEnd"};return!1}(),_=function(){if(void 0!==f.transitionProperty)return{property:"transition",event:"transitionend"};for(var e,t=0,n=u.length;t<n;t++)if(void 0!==f[u[t]+"TransitionProperty"])return e=u[t],{property:e+"Transition",event:e+"TransitionEnd"};return!1}(),p={alloc:[],node:e('<div class="ui-modal-dialog-mask" tableindex="0"></div>').css({position:"fixed",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%"}),show:function(e){s(p.alloc,e)===-1&&(p.alloc.push(e),p.node.insertBefore(e))},hide:function(e){p.alloc=l(p.alloc,function(t){return e!==t});var t=p.alloc.length;0===t?p.node.remove():p.node.insertBefore(p.alloc[t-1])}},h=/\s+/,v=e(window),m=e(document);return n.zIndex=1024,n.current=null,n.mask=p.node,n.prototype={node:null,fixed:!1,destroyed:!0,open:!1,returnValue:void 0,autofocus:!0,align:"bottom left",innerHTML:"",className:"ui-dialog",show:function(e){var t=this;if(t.destroyed)return t;t.open&&t.__close();var n=t.__node;return t.open=!0,t.follow=e||t.follow,t.__activeElement=t.__getActive(),t.__ready||(t.__ready=!0,n.addClass(t.className).attr("role",t.modal?"alertdialog":"dialog").css("position",t.fixed?"fixed":"absolute"),n.appendTo(document.body),t.modal&&n.addClass(t.className+"-modal")),t.__innerHTML!==t.innerHTML&&(n.html(t.innerHTML),t.__innerHTML=t.innerHTML),t.modal&&p.show(t.node),n.addClass(t.className+"-show").show(),t.reset().focus(),t.__dispatchEvent("show"),t},showModal:function(e){var t=this;return t.modal=!0,t.show(e)},__close:function(e,n){function o(){a.hide().removeClass(r.className+"-close")}var r=this;void 0!==e&&(r.returnValue=e);var i=r.node,a=r.__node;if(a.removeClass(r.className+"-show").addClass(r.className+"-close"),console.log(!d&&!_),d||_)if(n){var l,s=0;if(d&&"none"!==t(i,d.property+"Name")&&parseFloat(t(i,d.property+"Duration"))>0&&(s++,l=d.event),_&&"none"!==t(i,_.property+"Property")&&parseFloat(t(i,_.property+"Duration"))>0&&(s++,l+=(l?" ":"")+_.event),s){var c=function(){--s||(o(),a.off(l,c))};a.on(l,c)}else o()}else o();else o();r.modal&&(p.hide(r.node),r.modal=!1),r.open=!1},close:function(e){var t=this;return!t.destroyed&&t.open&&(t.__close(e,!0),t.blur(),t.__dispatchEvent("close")),t},remove:function(){var e=this;if(e.destroyed)return e;if(e.__dispatchEvent("beforeremove")===!1)return e;n.current===e&&(n.current=null),e.open&&e.modal&&p.hide(e.node),e.__node.remove(),e.__dispatchEvent("remove");for(var t in e)delete e[t];return e},reset:function(){var e=this,t=e.follow;return t?e.__follow(t):e.__center(),e.__dispatchEvent("reset"),e},focus:function(){var t=this,o=t.node,r=n.current,i=t.__node,a=t.zIndex=n.zIndex++;if(r&&r!==this&&r.blur(!1),!e.contains(o,t.__getActive())){var l=i.find("[autofocus]")[0];!t._autofocus&&l?t._autofocus=!0:l=o,t.__focus(l)}return i.css("zIndex",a),p.node.css("zIndex",a),n.current=t,i.addClass(t.className+"-focus"),t.__dispatchEvent("focus"),t},blur:function(){var e=this,t=arguments[0],n=e.__activeElement;return t!==!1&&e.__focus(n),e._autofocus=!1,e.__node.removeClass(e.className+"-focus"),e.__dispatchEvent("blur"),e},addEventListener:function(e,t){var n=this;return n.__getEventListeners(e).push(t),n},removeEventListener:function(e,t){for(var n=this,o=n.__getEventListeners(e),r=0;r<o.length;r++)t===o[r]&&o.splice(r--,1);return n},__getEventListeners:function(e){var t=this,n=t.__listeners;return n||(n=t.__listeners={}),n[e]||(n[e]=[]),n[e]},__dispatchEvent:function(e){var t,n=this,o=n.__getEventListeners(e);n["on"+e]&&(t=n["on"+e].call(n));for(var r,i=0,a=o.length;i<a;i++)r=o[i].call(n),t!==!1&&(t=r);return t},__focus:function(e){try{this.autofocus&&!/^iframe$/i.test(e.nodeName)&&e.focus()}catch(t){}},__getActive:function(){try{var e=document.activeElement,t=e.contentDocument,n=t&&t.activeElement||e;return n}catch(o){}},__center:function(){var e=this,t=e.__node,n=e.fixed,o=n?0:m.scrollLeft(),r=n?0:m.scrollTop(),i=v.width(),a=v.height(),l=t.width(),s=t.height(),c=(i-l)/2+o,f=382*(a-s)/1e3+r,u=e.node.style;u.left=Math.max(parseInt(c),o)+"px",u.top=Math.max(parseInt(f),r)+"px"},__follow:function(t){var n=this,o=n.__node;if(n.__align&&o.removeClass(n.__align),t=t.parentNode&&e(t),!t||!t.length)return n.__center();if(t){var r=t.offset();if(r.left*r.top<0)return n.__center()}var i=n.fixed,a=v.width(),l=v.height(),s=m.scrollLeft(),f=m.scrollTop(),u=o.width(),d=o.height(),u=t?t.outerWidth():0,d=t?t.outerHeight():0,r=n.__offset(t[0]),_=r.left,p=r.top,g=i?_-s:_,y=i?p-f:p,w=i?0:s,E=i?0:f,x=w+a-u,b=E+l-d,N={},L=n.align.split(h),T=n.className+"-",C={top:"bottom",bottom:"top",left:"right",right:"left"},M={top:"top",bottom:"top",left:"left",right:"left"},I=[{top:y-d,bottom:y+d,left:g-u,right:g+u},{top:y,bottom:y-d+d,left:g,right:g-u+u}],A={left:g+u/2-u/2,top:y+d/2-d/2},H={left:[w,x],top:[E,b]};c(L,function(e,t){I[t][e]>H[M[e]][1]&&(e=L[t]=C[e]),I[t][e]<H[M[e]][0]&&(L[t]=C[e])}),L[1]||(M[L[1]]="left"===M[L[0]]?"top":"left",I[1][L[1]]=A[M[L[1]]]),T+=L.join("-")+" "+n.className+"-follow",n.__align=T,o.addClass(T),N[M[L[0]]]=parseInt(I[0][L[0]]),N[M[L[1]]]=parseInt(I[1][L[1]]),o.css(N)},__offset:function(t){var n=t.parentNode,o=n?e(t).offset():{left:t.pageX,top:t.pageY};t=n?t:t.target;var r=t.ownerDocument,i=r.defaultView||r.parentWindow;if(i==window)return o;r=e(r);var a=r.scrollLeft(),l=r.scrollTop(),s=i.frameElement,c=e(s).offset(),f=c.left,u=c.top;return{left:o.left+f-a,top:o.top+u-l}}},n});
//# sourceMappingURL=dialog.js.map